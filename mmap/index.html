<!DOCTYPE html>

<html>

        <head>
                <title>Dylan's Marauder's Map</title>
                <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
                <meta charset="utf-8" />
                <link rel="stylesheet" href="mmapStyle.css" />
                <script src="http://maps.google.com/maps/api/js?sensor=true"></script>
                <script>
                        var myLat = 0;
                        var myLng = 0;
                        var response = new XMLHttpRequest();
                        var me = new google.maps.LatLng(myLat, myLng);
                        var map;
                        var mapOptions = {
                                zoom: 13,
                                center: me,
                                mapTypeId: google.maps.MapTypeId.ROADMAP
                        };
                        var marker;
                        var markerOptions = {
                                title: "KyleBroflovski",
                                position: me
                        };
                        var infoWindow = new google.maps.InfoWindow();

                        function init() {
                                map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
                                console.log("Before get my location");
                                getMyLocation();
                        }

                        function getMyLocation() {
                                if (navigator.geolocation) {
                                        navigator.geolocation.getCurrentPosition(function(position) {
                                                myLat = position.coords.latitude;
                                                myLng = position.coords.longitude;
                                                /* Make a marker for my location */
                                                makeMarker();
                                                renderMap();
                                                });
                                } else {
                                        alert("Geolocation is not supported on your web browser -- cannot display map");
                                }
                                console.log("After getting location");
                        }

                        function makeMarker() {
                                me = new google.maps.LatLng(myLat, myLng);
                                map.panTo(me);
                                markerOptions.position = me;

                                marker = new google.maps.marker(markerOptions);
                        }

                        function renderMap() {
                                me = new google.maps.LatLng(myLat, myLng);

                                map.panTo(me);
                        }
                </script>
        </head>


        <body onload=init()>
                <div id="map_canvas"></div>
        </body>

</html>